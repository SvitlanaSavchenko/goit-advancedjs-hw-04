{"version":3,"file":"commonHelpers.js","sources":["../src/index.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst searchForm = document.getElementById('search-form');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst gallery = document.getElementById('gallery');\n\nlet page = 1;\nlet searchQuery = '';\nlet totalHits = 0; // зберігаємо загальну кількість зображень\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\nconst baseURL = 'https://pixabay.com/api/';\nconst apiKey = '41042730-e71566aaa26e0b69c1c299757';\n\nconst fetchImages = async (query, pageNumber, perPage = 40) => {\n  try {\n    const response = await axios.get(baseURL, {\n      params: {\n        key: apiKey,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: pageNumber,\n        per_page: perPage,\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    return [];\n  }\n};\n\nconst displayImages = images => {\n  const htmlString = images\n    .map(\n      image => `\n    <div class=\"photo-card\">\n      <a href=\"${image.largeImageURL}\" data-lightbox=\"image\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\">\n        <p class=\"info-item\"><b>Likes:</b> ${image.likes}</p>\n        <p class=\"info-item\"><b>Views:</b> ${image.views}</p>\n        <p class=\"info-item\"><b>Comments:</b> ${image.comments}</p>\n        <p class=\"info-item\"><b>Downloads:</b> ${image.downloads}</p>\n      </div>\n    </div>\n  `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', htmlString);\n};\n\nconst showMessage = message => {\n  iziToast.info({\n    message: message,\n    theme: 'dark',\n    position: 'topCenter',\n  });\n};\n\nloadMoreBtn.style.display = 'none';\n\nconst toggleLoadMoreButton = () => {\n  if (totalHits > 0 && (page - 1) * 40 < totalHits) {\n    loadMoreBtn.style.display = 'block';\n  } else {\n    loadMoreBtn.style.display = 'none';\n  }\n};\n\nloadMoreBtn.style.display = 'none';\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  searchQuery = event.target.elements.searchQuery.value.trim();\n\n  if (searchQuery === '') {\n    showMessage('Please enter a search term');\n    return;\n  }\n\n  page = 1;\n  const data = await fetchImages(searchQuery, page);\n\n  if (data.totalHits === 0) {\n    showMessage(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n    gallery.innerHTML = '';\n    toggleLoadMoreButton();\n    return;\n  }\n\n  gallery.innerHTML = '';\n  totalHits = data.totalHits;\n  displayImages(data.hits);\n  lightbox.refresh();\n  showMessage(`Hooray! We found ${data.totalHits} images.`);\n  toggleLoadMoreButton();\n\n  const totalPages = Math.ceil(data.totalHits / data.perPage);\n  if (data.pageNumber >= totalPages) {\n    showMessage(\"We're sorry, but you've reached the end of search results.\");\n    toggleLoadMoreButton();\n    return;\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  page++;\n  const data = await fetchImages(searchQuery, page);\n\n  if (data.hits.length === 0) {\n    showMessage(\"We're sorry, but you've reached the end of search results.\");\n    toggleLoadMoreButton();\n    return;\n  }\n\n  displayImages(data.hits);\n  lightbox.refresh();\n\n  const totalPages = Math.ceil(data.totalHits / data.perPage);\n  if (data.pageNumber >= totalPages) {\n    showMessage(\"We're sorry, but you've reached the end of search results.\");\n    toggleLoadMoreButton();\n    return;\n  }\n});\n"],"names":["searchForm","loadMoreBtn","gallery","page","searchQuery","totalHits","lightbox","SimpleLightbox","baseURL","apiKey","fetchImages","query","pageNumber","perPage","axios","error","displayImages","images","htmlString","image","showMessage","message","iziToast","toggleLoadMoreButton","event","data","totalPages"],"mappings":"owBAMA,MAAMA,EAAa,SAAS,eAAe,aAAa,EAClDC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAU,SAAS,eAAe,SAAS,EAEjD,IAAIC,EAAO,EACPC,EAAc,GACdC,EAAY,EAEhB,MAAMC,EAAW,IAAIC,EAAe,YAAY,EAE1CC,EAAU,2BACVC,EAAS,qCAETC,EAAc,MAAOC,EAAOC,EAAYC,EAAU,KAAO,CAC7D,GAAI,CAaF,OAZiB,MAAMC,EAAM,IAAIN,EAAS,CACxC,OAAQ,CACN,IAAKC,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUC,CACX,CACP,CAAK,GAEe,IACjB,OAAQE,EAAP,CACA,eAAQ,MAAM,yBAA0BA,CAAK,EACtC,EACR,CACH,EAEMC,EAAgBC,GAAU,CAC9B,MAAMC,EAAaD,EAChB,IACCE,GAAS;AAAA;AAAA,iBAEEA,EAAM;AAAA,oBACHA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA,6CAGTA,EAAM;AAAA,6CACNA,EAAM;AAAA,gDACHA,EAAM;AAAA,iDACLA,EAAM;AAAA;AAAA;AAAA,GAIlD,EACA,KAAK,EAAE,EAEVjB,EAAQ,mBAAmB,YAAagB,CAAU,CACpD,EAEME,EAAcC,GAAW,CAC7BC,EAAS,KAAK,CACZ,QAASD,EACT,MAAO,OACP,SAAU,WACd,CAAG,CACH,EAEApB,EAAY,MAAM,QAAU,OAE5B,MAAMsB,EAAuB,IAAM,CAC7BlB,EAAY,IAAMF,EAAO,GAAK,GAAKE,EACrCJ,EAAY,MAAM,QAAU,QAE5BA,EAAY,MAAM,QAAU,MAEhC,EAEAA,EAAY,MAAM,QAAU,OAE5BD,EAAW,iBAAiB,SAAU,MAAMwB,GAAS,CAInD,GAHAA,EAAM,eAAc,EACpBpB,EAAcoB,EAAM,OAAO,SAAS,YAAY,MAAM,OAElDpB,IAAgB,GAAI,CACtBgB,EAAY,4BAA4B,EACxC,MACD,CAEDjB,EAAO,EACP,MAAMsB,EAAO,MAAMf,EAAYN,EAAaD,CAAI,EAEhD,GAAIsB,EAAK,YAAc,EAAG,CACxBL,EACE,0EACN,EACIlB,EAAQ,UAAY,GACpBqB,IACA,MACD,CAEDrB,EAAQ,UAAY,GACpBG,EAAYoB,EAAK,UACjBT,EAAcS,EAAK,IAAI,EACvBnB,EAAS,QAAO,EAChBc,EAAY,oBAAoBK,EAAK,mBAAmB,EACxDF,IAEA,MAAMG,EAAa,KAAK,KAAKD,EAAK,UAAYA,EAAK,OAAO,EAC1D,GAAIA,EAAK,YAAcC,EAAY,CACjCN,EAAY,4DAA4D,EACxEG,IACA,MACD,CACH,CAAC,EAEDtB,EAAY,iBAAiB,QAAS,SAAY,CAChDE,IACA,MAAMsB,EAAO,MAAMf,EAAYN,EAAaD,CAAI,EAEhD,GAAIsB,EAAK,KAAK,SAAW,EAAG,CAC1BL,EAAY,4DAA4D,EACxEG,IACA,MACD,CAEDP,EAAcS,EAAK,IAAI,EACvBnB,EAAS,QAAO,EAEhB,MAAMoB,EAAa,KAAK,KAAKD,EAAK,UAAYA,EAAK,OAAO,EAC1D,GAAIA,EAAK,YAAcC,EAAY,CACjCN,EAAY,4DAA4D,EACxEG,IACA,MACD,CACH,CAAC"}